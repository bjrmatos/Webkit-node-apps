!function(){function e(e){if(i.selection().value.length>0)i.wrap(e+" ","");else{var t=e+" Heading "+e.length+"\n\n";i.insert(t,function(){var n=i.selection().start;i.select(n-t.length+e.length+1,n-2)})}}function t(e){var t=e.hash.replace("#","");r[t]&&(e.onclick=function(){return r[t](),!1})}String.prototype.capitalize=function(e){return(e?this.toLowerCase():this).replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})};for(var n=document.querySelector("#editor-area"),o=document.querySelector("#editor-control").getElementsByTagName("a"),i=new Editor(n),r={bold:function(){i.wrap("**","**")},italic:function(){i.wrap("_","_")},code:function(){i.wrap("`","`")},"code-block":function(){i.indent(" ")},quote:function(){i.indent("> ")},"ul-list":function(){var e=i.selection(),t="";if(e.value.length>0)i.indent("",function(){i.replace(/^[^\n\r]/gm,function(e){return t+="- ",e.replace(/^/,"- ")}),i.select(e.start,e.end+t.length)});else{var n="- List Item";i.indent(n,function(){i.select(e.start+2,e.start+n.length)})}},"ol-list":function(){var e=i.selection(),t=0,n="";if(e.value.length>0)i.indent("",function(){i.replace(/^[^\n\r]/gm,function(e){return t++,n+=t+". ",e.replace(/^/,t+". ")}),i.select(e.start,e.end+n.length)});else{var o="1. List Item";i.indent(o,function(){i.select(e.start+3,e.start+o.length)})}},link:function(){var e=(i.selection(),null),t=null;fakePrompt("Link title:","Title of link",!1,function(n){e=n,fakePrompt("URL:","http://",!0,function(n){t=n,i.insert("\n["+e+"]("+n+")\n")})})},image:function(){fakePrompt("Image URL:","http://",!0,function(e){var t=e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")).replace(/[\-\_\+]+/g," ").capitalize();t=t.indexOf("/")<0?decodeURIComponent(t):"Image",i.insert("\n!["+t+"]("+e+")\n")})},h1:function(){e("#")},h2:function(){e("##")},h3:function(){e("###")},h4:function(){e("####")},h5:function(){e("#####")},h6:function(){e("######")},hr:function(){i.insert("\n\n---\n\n")},select:function(){i.select(0,n.value.length)},undo:function(){i.undo()},redo:function(){i.redo()}},c=0,l=o.length;l>c;++c)t(o[c]),o[c].href="#";var a=0;i.area.onkeydown=function(e){return 5>a?a++:(i.updateHistory(),a=0),9==e.keyCode?(i.indent("    "),!1):void 0};var u=new Showdown.converter,f=document.querySelector("#eye"),d=document.querySelector("#editor-area"),g=document.querySelector(".result");if(s=document.querySelector("#state"),f.onclick=function(){g.innerHTML=u.makeHtml(d.value),g.classList.toggle("show"),d.classList.toggle("hide"),this.classList.toggle("active")},null!==localStorage){d.value=localStorage.getItem("markdown_text_saved"),s.textContent="Loaded";{setInterval(function(){localStorage.setItem("markdown_text_saved",d.value),s.textContent="Save";var e=setTimeout(function(){s.textContent=" ",clearTimeout(e)},1e3)},1e4)}}}();
